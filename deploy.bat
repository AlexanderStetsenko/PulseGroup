@echo off
chcp 65001 > nul
echo.
echo ?? PulseGroup Bot Deployment
echo ==============================
echo.

REM Check if Docker is running
docker info >nul 2>&1
if errorlevel 1 (
    echo ? Docker ?? ???????!
    echo ????????? Docker Desktop
    pause
    exit /b 1
)

echo ? Docker ???????
echo.

REM Create data directory if it doesn't exist
if not exist "data" (
    echo ?? ?????? ?????????? ??? ??????...
    mkdir data
    echo ? ?????????? data ???????
) else (
    echo ? ?????????? data ??? ??????????
)
echo.

REM Show menu
echo ???????? ????????:
echo 1) ????????? ????
echo 2) ?????????? ????
echo 3) ????????????? ????
echo 4) ???????? ????
echo 5) ??????????? ? ?????????
echo 6) ?????????? ? ??????? ?????????
echo.
set /p choice="??????? ????? (1-6): "

if "%choice%"=="1" goto start
if "%choice%"=="2" goto stop
if "%choice%"=="3" goto restart
if "%choice%"=="4" goto logs
if "%choice%"=="5" goto rebuild
if "%choice%"=="6" goto remove
goto invalid

:start
echo.
echo ?? ???????? ????...
docker-compose up -d
echo.
echo ? ??? ???????!
echo ??? ????????? ?????: docker-compose logs -f
goto end

:stop
echo.
echo ?? ???????????? ????...
docker-compose down
echo ? ??? ??????????!
goto end

:restart
echo.
echo ?? ???????????? ????...
docker-compose restart
echo ? ??? ???????????!
goto end

:logs
echo.
echo ?? ???? ???? (Ctrl+C ??? ??????):
echo.
docker-compose logs -f
goto end

:rebuild
echo.
echo ?? ??????????? ?????...
docker-compose build --no-cache
echo.
echo ?? ???????? ????...
docker-compose up -d
echo.
echo ? ??? ?????????? ? ???????!
goto end

:remove
echo.
echo ??? ???????????? ? ?????? ?????????...
docker-compose down
docker rmi pulsegroup-pulsegroup-bot 2>nul
echo ? ????????? ??????!
echo ?? ?????? ? ?????????? data ?????????
goto end

:invalid
echo.
echo ? ???????? ?????!
goto end

:end
echo.
pause
